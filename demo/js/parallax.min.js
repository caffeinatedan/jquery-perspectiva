(function(){var b=function(c){this.init(c);return this};b.prototype={init:function(c){var d=$.extend(true,{position:{x:0,y:0},xAxis:true,yAxis:true,xSpeed:0,ySpeed:0,xRange:[0,1],yRange:[0,1]},c);$.extend(this,d);this.element=$("<img />").attr("src",this.src);this.element.load(function(){$(this).trigger("ready.parallax")});this.element.css({position:"absolute",top:(this.position.y*100)+"%",left:(this.position.x*100)+"%"})},render:function(c){c.append(this.element);return this},move:function(c){var e={},d,h,f=Math.abs(this.element.width()-this.viewport.width),g=Math.abs(this.element.height()-this.viewport.height);if(this.xAxis){e.marginLeft=(c.x*100*this.xSpeed);d=f*100/this.viewport.width;if(Math.abs(e.marginLeft)<=d){e.marginLeft+="%"}else{delete e.marginLeft}}if(this.yAxis){e.marginTop=(c.y*100*this.ySpeed);h=g*100/this.viewport.height;if(Math.abs(e.marginTop)<=h){e.marginTop+="%"}else{delete e.marginTop}}this.element.css(e)}};var a=function(d,c){this.init(d,c);return this};a.prototype={init:function(d,c){this.options=$.extend({},c);this.element=d;this.layers=[];this.width=this.element.width();this.height=this.element.height();this.layersReady=0;this.initLayers()},_onLayerReady:function(){var c=this;this.layersReady++;if(this.layersReady===this.layers.length){this.element.on("mousemove.parallax",function(d){var f=$(this).offset(),e={x:d.pageX-f.left,y:d.pageY-f.top};c.animate(e)});this.options.ready&&this.options.ready()}},initLayers:function(){var c=this.options.layers.length,e,d,f=this;for(d=0;d<c;d++){this.options.layers[d].viewport=this;e=new b(this.options.layers[d]);e.element.bind("ready.parallax",function(){f._onLayerReady()});this.layers.push(e);e.render(this.element)}},animate:function(c){var f,e,d,g=this.layers.length;d={x:(c.x/this.width),y:(c.y/this.height)};for(f=0;f<g;f++){e=this.layers[f];e.move(d)}return this}};$.fn.parallax=function(c){return $(this).each(function(){new a($(this),c)})}})();