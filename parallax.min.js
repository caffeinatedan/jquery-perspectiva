(function(){var b=function(c){this.init(c);return this};b.prototype={init:function(c){var d=$.extend(true,{xAxis:true,yAxis:true,xSpeed:0.2,ySpeed:0.2,xRange:[0,1],yRange:[0,1]},c);$.extend(this,d);this.element=$("<img />").attr("src",this.src);this.element.load(function(){$(this).trigger("ready.parallax")});this.element.css({position:"absolute",left:(this.xRange[0]*100)+"%",top:(this.yRange[0]*100)+"%"})},render:function(c){c.append(this.element);return this},move:function(f){var g={},h,d,e,c,k,i=Math.abs(this.element.width()-this.viewport.width),j=Math.abs(this.element.height()-this.viewport.height);if(this.xAxis){g.marginLeft=(f.x*100*this.xSpeed);h=i*100/this.viewport.width;e=((this.xRange[1]-this.xRange[0])*100);if(Math.abs(g.marginLeft)<=h&&e>=g.marginLeft){g.marginLeft+="%"}else{delete g.marginLeft}}if(this.yAxis){g.marginTop=(f.y*100*this.ySpeed);d=j*100/this.viewport.height;if(Math.abs(g.marginTop)<=d){g.marginTop+="%"}else{delete g.marginTop}}this.element.css(g)}};var a=function(d,c){this.init(d,c);return this};a.prototype={init:function(d,c){this.options=$.extend({},c);this.element=d;this.layers=[];this.width=this.element.width();this.height=this.element.height();this.layersReady=0;this.initLayers()},_onLayerReady:function(){var c=this;this.layersReady++;if(this.layersReady===this.layers.length){this.element.on("mousemove.parallax",function(d){var f=$(this).offset(),e={x:d.pageX-f.left,y:d.pageY-f.top};c.animate(e)});this.options.ready&&this.options.ready()}},initLayers:function(){var c=this.options.layers.length,e,d,f=this;for(d=0;d<c;d++){this.options.layers[d].viewport=this;e=new b(this.options.layers[d]);e.element.bind("ready.parallax",function(){f._onLayerReady()});this.layers.push(e);e.render(this.element)}},animate:function(c){var f,e,d,g=this.layers.length;d={x:(c.x/this.width),y:(c.y/this.height)};for(f=0;f<g;f++){e=this.layers[f];e.move(d)}return this}};$.fn.parallax=function(c){return $(this).each(function(){new a($(this),c)})}})();